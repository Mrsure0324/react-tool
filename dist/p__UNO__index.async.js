"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[198],{79312:function(Qn,G,r){r.r(G),r.d(G,{default:function(){return Bn}});var en=r(25359),U=r.n(en),tn=r(49811),on=r.n(tn),an=r(93525),rn=r.n(an),ln=r(54306),x=r.n(ln),v=r(93236),E={"flex-between":"flex-between___bfW2N",box:"box___x16Kb",inner:"inner___uwIyM","total-item":"total-item___UBkqK",winner:"winner___V4ukZ",loser:"loser___zrkXt"},z=r(35686),A=r(2725),I=r(41410),p=r(65804),$=r(27824),un=r(71258),L=r(59568),sn=r(93161),H=r(43872),cn=r(2362),K=r(42112),V=r(95110),dn=r(43994),vn=r(13655),fn=r(66965),pn=r(33943),mn=r(36240),d=r(32699),hn=r(45924),xn=r(11333),Fn=r.n(xn),yn=r(95170),Z=r.n(yn);function jn(N){var m=N.filter(function(h){return h.point>0}),F=N.filter(function(h){return h.point<0});m.sort(function(h,y){return y.point-h.point}),F.sort(function(h,y){return h.point-y.point});for(var s=[],l=0,T=0;T<m.length;T++)for(var B=m[T],C=B.point;C>0&&l<F.length;){var P=F[l],S=Math.abs(P.point);S<=C?(s.push({winner:B.name,loser:P.name,amount:S}),C-=S,l++):(s.push({winner:B.name,loser:P.name,amount:C}),P.point+=C,C=0)}return s}var gn=[{name:"Ye\u54E5",point:0,type:"normal"},{name:"Sure",point:0,type:"normal"},{name:"\u4E09\u91D1",point:0,type:"normal"},{name:"\u82D7\u82D7",point:0,type:"normal"},{name:"\u73A5\u73A5",point:0,type:"normal"}],Cn=r(13840),n=r(62086),Dn=function(m){var F=(0,v.useMemo)(function(){var s=[];for(var l in m.result)l!=="date"&&s.push({point:m.result[l],name:l});return s},[m.result]);return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(z.Z,{header:!1,footer:!1,bordered:!0,dataSource:F,style:{width:"100%"},renderItem:function(l){return(0,n.jsxs)(z.Z.Item,{children:[(0,n.jsx)(A.Z.Text,{children:l==null?void 0:l.name}),l.point>0&&(0,n.jsx)(A.Z.Text,{style:{color:"red"},children:l==null?void 0:l.point}),l.point==0&&(0,n.jsx)(A.Z.Text,{children:l==null?void 0:l.point}),l.point<0&&(0,n.jsx)(A.Z.Text,{style:{color:"green"},children:l==null?void 0:l.point})]})}})})},b=!0,Zn=function(){var m=v.useState([]),F=x()(m,2),s=F[0],l=F[1],T=v.useState(0),B=x()(T,2),C=B[0],P=B[1],S=I.Z.useForm(),h=x()(S,1),y=h[0],En=v.useState([]),k=x()(En,2),j=k[0],O=k[1],Tn=v.useState(!1),X=x()(Tn,2),Pn=X[0],Y=X[1],Sn=v.useState(!1),J=x()(Sn,2),Rn=J[0],Q=J[1],An=v.useState(!0),W=x()(An,2),M=W[0],q=W[1],In=v.useState({}),_=x()(In,2),$n=_[0],Nn=_[1];(0,v.useEffect)(function(){b&&(Z().getItem("players").then(function(o){l(o||[])}),Z().getItem("logs").then(function(o){O(o||[])}),b=!1)},[]);var nn=function(t){var e=0;return j.forEach(function(u){e+=u[t]||0}),Number(e||0)},On=(0,v.useMemo)(function(){var o=(0,d.cloneDeep)(j),t={date:"\u603B\u8BA1"};return s.forEach(function(e){t[e.name]=nn(e.name)}),Nn(t),o.reverse()},[j,s]),wn=(0,v.useMemo)(function(){var o=s.map(function(t){var e;return{title:t.name,dataIndex:t.name,key:t.name,width:Math.max(Math.min(((e=t.name)===null||e===void 0?void 0:e.length)*25,80),70),render:function(c){var a=Math.round(c*100)/100;return(0,n.jsxs)(n.Fragment,{children:[Number(a)>0&&(0,n.jsx)("span",{style:{color:"red"},children:"+".concat(a)}),!Number(a)&&"".concat(0),Number(a)<0&&(0,n.jsx)("span",{style:{color:"green"},children:"".concat(a)})]})}}});return[{title:"\u65E5\u671F",dataIndex:"date",key:"date",width:100}].concat(rn()(o),[{title:"\u64CD\u4F5C",width:50,fixed:"right",render:function(e,u,c){return(0,n.jsx)(n.Fragment,{children:c!==j.length&&(0,n.jsx)(p.ZP,{style:{paddingLeft:0},danger:!0,onClick:function(){return Mn(u,c)},type:"link",children:"\u5220\u9664"})})}}])},[s,j]),Ln=function(){Z().setItem("players",[]),Z().setItem("logs",[]),O([]),l([])},Mn=function(t,e){var u=(0,d.cloneDeep)(j[e]);$.Z.confirm({title:"\u8B66\u544A",content:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",onOk:function(){var a=(0,d.cloneDeep)(j);a.splice(e,1),O(a)}})},Gn=function(){var o=on()(U()().mark(function t(){var e,u;return U()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,y.validateFields();case 3:e=y.getFieldsValue(),u=(0,d.cloneDeep)(s),u.push({name:e.name,description:"",avatar:"",point:0,type:"normal"}),l(u),y.resetFields(),un.ZP.success((0,n.jsx)(n.Fragment,{children:"\u70ED\u70C8\u6B22\u8FCE\u3010".concat(e.name,"\u3011\u540C\u5FD7\u52A0\u5165\u6E38\u620F\uFF0C\u795D\u60A8\u798F\u5982\u4E1C\u6D77\uFF0C\u5BFF\u6BD4\u5357\u5C71~")})),a.next=13;break;case 11:a.prev=11,a.t0=a.catch(0);case 13:case"end":return a.stop()}},t,null,[[0,11]])}));return function(){return o.apply(this,arguments)}}(),Un=function(t){var e=(0,d.cloneDeep)(s[t]);$.Z.confirm({title:"\u8B66\u544A",content:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u3010".concat(e.name,"\u3011\u5417\uFF1F"),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",onOk:function(){var c=(0,d.cloneDeep)(s);c.splice(t,1),l(c)}})},zn=function(t,e){if(e!==null){var u=(0,d.cloneDeep)(s);u[t].point=e,l(u)}},Hn=function(){var t=(0,d.cloneDeep)(s);t=t.map(function(e,u){return{name:e.name,description:e.description,avatar:e.avatar,point:0,type:"normal"}}),console.log(t),l(t),q(!1)},Kn=function(t){var e={};return e.date=Fn()().format("HH:mm:ss"),t.forEach(function(u,c){e[u.name]=u.lastPoint}),e},Vn=function(){var t,e=(0,d.cloneDeep)(s);e.sort(function(f,w){return f.point-w.point});var u=0,c=(t=(0,d.cloneDeep)(e[1]))===null||t===void 0?void 0:t.point,a=0;e.map(function(f,w){(f==null?void 0:f.point)<=c?(f.type="winner",a++):f.type="loser"}),l(e);var R=bn(e,a),i=R.result,D=(0,d.cloneDeep)(j),g=Kn(i);D.push(g),O(D),Z().setItem("players",e),Z().setItem("logs",D),q(!0),$.Z.info({width:"80%",icon:(0,n.jsx)(n.Fragment,{}),title:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("p",{children:"\u{1F3C6}\u{1F3C6}\u{1F3C6}\u7ED3\u7B97\u9875\u9762\u{1F3C6}\u{1F3C6}\u{1F3C6}"})}),content:(0,n.jsx)(Dn,{result:g}),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"})},bn=function(t,e){var u=t.filter(function(i){return i.type==="winner"}),c=0;t==null||t.forEach(function(i,D){i.type==="loser"&&(c+=i.point)});var a=c/e,R=t.map(function(i,D){var g=a;return i.type==="winner"?D===0?u==null||u.forEach(function(f,w){if(w!==0){var Jn=Math.min(f==null?void 0:f.point,a);g=g+Jn}}):g=a-(i==null?void 0:i.point)<0?0:a-(i==null?void 0:i.point):g=-(i==null?void 0:i.point),{rank:D+1,name:i==null?void 0:i.name,lastPoint:g}});return{result:R,plan:[]}},kn=function(t){return t==="winner"?"red":t==="loser"?"green":"blue"},Xn=function(){var t=(0,d.cloneDeep)($n);delete t.date;var e=[];for(var u in t)e.push({name:u,point:t[u]});e.sort(function(a,R){return R.point-a.point});var c=jn(e);$.Z.info({width:"80%",icon:(0,n.jsx)(n.Fragment,{}),title:(0,n.jsx)(n.Fragment,{children:"\u7ED3\u7B97\u65B9\u6848"}),content:(0,n.jsx)(n.Fragment,{children:c.map(function(a){return(0,n.jsxs)("div",{style:{fontSize:"16px"},children:[(0,n.jsxs)("span",{children:["\u3010",a==null?void 0:a.loser,"\u3011"]}),(0,n.jsx)("span",{children:"\u8F93\u7ED9"}),(0,n.jsxs)("span",{children:["\u3010",a==null?void 0:a.winner,"\u3011"]}),(0,n.jsx)("span",{style:{color:"red"},children:Math.round((a==null?void 0:a.amount)*10)/10/10}),"\u5143"]})})}),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"})},Yn=function(){l(gn)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(hn._z,{title:"UNO\u8BA1\u5206\u5668",className:E.box,style:{minHeight:"100vh"},children:(0,n.jsxs)("div",{className:E.inner,children:[(0,n.jsx)("p",{style:{color:"orange"},children:"\u6CE8\uFF1A\u7B2C\u4E00\u540D\u4EE5\u53CA\u5E76\u5217\u7B2C\u4E00\uFF0C\u76F4\u63A5\u8F93\u51650\u5373\u53EF"}),(0,n.jsx)(L.Z,{direction:"vertical",size:"middle",style:{width:"100%"},children:s.map(function(o,t){return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(sn.Z.Ribbon,{text:(0,n.jsxs)(n.Fragment,{children:[(o==null?void 0:o.type)==="winner"&&"Winner \u{1F911}",(o==null?void 0:o.type)==="loser"&&"Loser \u{1F62D}",(o==null?void 0:o.type)==="normal"&&"Ready \u{1F60E}"]}),color:kn(o==null?void 0:o.type),children:(0,n.jsx)(H.Z,{title:o.name,size:"small",children:(0,n.jsxs)("div",{className:E["flex-between"],children:[(0,n.jsx)(cn.Z,{disabled:M,addonBefore:"-",width:50,min:0,value:o.point,onChange:function(u){return zn(t,u)}}),(0,n.jsx)(p.ZP,{danger:!0,type:"link",onClick:function(){return Un(t)},children:"\u8E22\u51FA\u623F\u95F4"})]})})},t)})})}),(0,n.jsx)(K.Z,{}),(0,n.jsxs)(L.Z,{children:[(0,n.jsx)(p.ZP,{color:"success",disabled:M,type:"primary",onClick:Vn,children:"\u7ED3\u7B97\u672C\u5C40"}),(0,n.jsx)(p.ZP,{color:"success",type:"primary",onClick:function(){Y(!0)},children:"\u8BB0\u5206\u677F"}),(0,n.jsx)(p.ZP,{color:"success",disabled:!M,type:"primary",onClick:function(){Hn()},children:"\u65B0\u5F00\u4E00\u5C40"})]})]})}),(0,n.jsxs)(V.Z,{title:"\u8BB0\u5206\u677F",width:1200,open:Pn,onClose:function(){Y(!1)},children:[(0,n.jsx)(H.Z,{title:"\u5206\u6570\u603B\u8BA1\uFF1A",size:"small",children:(0,n.jsx)(dn.Z,{children:s.map(function(o,t){var e=nn(o.name),u="normal";return e>0&&(u="winner"),e<0&&(u="loser"),(0,n.jsx)(vn.Z,{span:8,children:(0,n.jsx)("div",{className:"".concat(E["total-item"]," ").concat(E[u]),children:"".concat(o.name,"\uFF1A").concat(e)})})})})}),(0,n.jsx)("br",{}),(0,n.jsx)(fn.Z,{scroll:{y:400},dataSource:On,columns:wn,pagination:!1,size:"small"}),(0,n.jsx)(K.Z,{}),(0,n.jsx)(p.ZP,{type:"primary",onClick:Xn,children:"\u751F\u6210\u7ED3\u7B97\u65B9\u6848"})]}),(0,n.jsx)(V.Z,{title:"\u64CD\u4F5C\u9762\u677F",placement:"bottom",open:Rn,onClose:function(){return Q(!1)},children:(0,n.jsxs)(I.Z,{form:y,children:[(0,n.jsx)(I.Z.Item,{rules:[{required:!0,message:"\u4F60\u5F97\u8D77\u4E2A\u540D\u554A"}],label:"Player Name",name:"name",children:(0,n.jsx)(pn.Z,{maxLength:8})}),(0,n.jsx)(I.Z.Item,{children:(0,n.jsxs)(L.Z,{children:[(0,n.jsx)(p.ZP,{onClick:Gn,children:"\u521B\u5EFA\u73A9\u5BB6"}),(0,n.jsx)(p.ZP,{onClick:Ln,children:"\u91CD\u5F00\u623F\u95F4"}),(0,n.jsx)(p.ZP,{onClick:Yn,children:"\u52A0\u8F7D\u9ED8\u8BA4\u73A9\u5BB6"})]})})]})}),(0,n.jsx)(mn.Z,{shape:"circle",style:{right:12},icon:(0,n.jsx)(Cn.Z,{}),onClick:function(){return Q(!0)}})]})},Bn=Zn}}]);
